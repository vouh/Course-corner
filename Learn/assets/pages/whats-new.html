<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What's New – Course Corner Learn</title>
    <link rel="icon" href="/favicon.ico" sizes="any">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://coursecornerkenya.com/assets/css/modern-ui.css">
    <link rel="stylesheet" href="https://coursecornerkenya.com/assets/css/auth.css">
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter',sans-serif;background:#f8fafc;color:#1f2937}

        /* ── Hero ── */
        .page-hero{
            padding-top:80px;
            background:linear-gradient(135deg,#0a1f10 0%,#111827 55%,#0d1e30 100%);
            position:relative;overflow:hidden;
        }
        .page-hero::before{content:'';position:absolute;top:-120px;right:-100px;width:560px;height:560px;background:radial-gradient(circle,rgba(22,163,74,.13) 0%,transparent 65%);pointer-events:none}
        .page-hero::after{content:'';position:absolute;bottom:-80px;left:-60px;width:400px;height:400px;background:radial-gradient(circle,rgba(14,165,233,.09) 0%,transparent 65%);pointer-events:none}
        .hero-inner{max-width:780px;margin:0 auto;padding:5rem 2rem 4rem;text-align:center;position:relative;z-index:1}
        .pill{display:inline-flex;align-items:center;gap:.5rem;background:rgba(22,163,74,.15);border:1px solid rgba(22,163,74,.3);color:#4ade80;padding:.4rem 1rem;border-radius:9999px;font-size:.8125rem;font-weight:600;margin-bottom:1.5rem;letter-spacing:.04em;text-transform:uppercase}
        .hero-title{font-size:clamp(2rem,4vw,3.25rem);font-weight:800;color:white;line-height:1.2;letter-spacing:-.025em;margin-bottom:1.25rem}
        .hero-title .g{background:linear-gradient(135deg,#4ade80,#38bdf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .hero-desc{font-size:1.0625rem;color:#d1d5db;line-height:1.7;max-width:580px;margin:0 auto}

        /* ── Post grid ── */
        .posts-section{max-width:1140px;margin:0 auto;padding:4rem 2rem 5rem}
        .posts-header{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:2.5rem}
        .posts-header h2{font-size:1.5rem;font-weight:800;color:#111827}
        .filter-tabs{display:flex;gap:.5rem;flex-wrap:wrap}
        .filter-tab{padding:.4rem 1rem;border-radius:9999px;font-size:.875rem;font-weight:600;border:1.5px solid #e5e7eb;background:white;color:#6b7280;cursor:pointer;transition:all .2s}
        .filter-tab.active,.filter-tab:hover{background:#16a34a;border-color:#16a34a;color:white}
        .posts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:2rem}

        /* card */
        .post-card{background:white;border-radius:1.5rem;overflow:hidden;border:1px solid #e5e7eb;transition:all .3s;cursor:pointer}
        .post-card:hover{transform:translateY(-5px);box-shadow:0 20px 48px rgba(0,0,0,.1);border-color:#d1fae5}
        .post-img{height:200px;display:flex;align-items:center;justify-content:center;font-size:3rem;position:relative;overflow:hidden}
        .post-img img{width:100%;height:100%;object-fit:cover}
        .post-img .overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.45) 0%,transparent 60%)}
        .post-img .cat-pill{position:absolute;top:14px;left:14px;font-size:.6875rem;font-weight:700;padding:.25rem .625rem;border-radius:9999px;text-transform:uppercase;letter-spacing:.05em}
        .post-body{padding:1.5rem}
        .post-body h3{font-size:1.0625rem;font-weight:700;color:#111827;margin-bottom:.625rem;line-height:1.4}
        .post-body p{font-size:.9rem;color:#6b7280;line-height:1.65;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
        .post-meta{display:flex;align-items:center;gap:.75rem;margin-top:.875rem;font-size:.8125rem;color:#9ca3af}
        .post-meta .dot{width:3px;height:3px;border-radius:50%;background:#d1d5db}
        .read-btn{display:inline-flex;align-items:center;gap:.375rem;margin-top:1.25rem;font-size:.875rem;font-weight:700;color:#16a34a;text-decoration:none;transition:gap .2s}
        .read-btn:hover{gap:.625rem}

        /* Featured card */
        .post-card.featured{grid-column:1/-1}
        @media(min-width:900px){
            .post-card.featured .inner{display:grid;grid-template-columns:1.2fr 1fr}
            .post-card.featured .post-img{height:100%;min-height:280px}
        }

        /* Newsletter strip */
        .nl-strip{background:linear-gradient(135deg,#16a34a,#0ea5e9);padding:3.5rem 2rem;text-align:center;color:white}
        .nl-strip h3{font-size:1.5rem;font-weight:800;margin-bottom:.5rem}
        .nl-strip p{font-size:.9375rem;opacity:.9;margin-bottom:1.75rem;max-width:440px;margin-left:auto;margin-right:auto;line-height:1.6}
        .nl-form{display:flex;gap:.75rem;max-width:400px;margin:0 auto;flex-wrap:wrap}
        .nl-form input{flex:1;min-width:0;padding:.75rem 1.25rem;border-radius:999px;border:none;font-size:.9375rem;outline:none}
        .nl-form button{padding:.75rem 1.5rem;background:#111827;color:white;font-weight:700;border:none;border-radius:999px;cursor:pointer;font-size:.9375rem;transition:all .2s}
        .nl-form button:hover{background:#0f172a;transform:scale(1.03)}

        /* Footer – same as index.html */
        .learn-footer { background:#0f172a; color:#94a3b8; padding:4rem 2rem 2rem; border-top:3px solid #16a34a; }
        .footer-inner { max-width:1240px; margin:0 auto; }
        .footer-top { display:grid; grid-template-columns:2fr 1fr 1fr 1fr; gap:3rem; padding-bottom:3rem; border-bottom:1px solid rgba(255,255,255,.08); margin-bottom:2rem; }
        .footer-brand .brand-logo-row { display:flex; align-items:center; gap:.75rem; margin-bottom:1.25rem; }
        .footer-brand .brand-logo-row img { width:44px; height:44px; object-fit:contain; }
        .footer-brand .brand-logo-row .fn { font-size:1.125rem; font-weight:800; color:#fff; line-height:1.1; }
        .footer-brand .brand-logo-row .fs { font-size:.625rem; font-weight:700; color:#0ea5e9; letter-spacing:.08em; text-transform:uppercase; }
        .footer-brand p { font-size:.9375rem; color:#64748b; line-height:1.7; max-width:260px; }
        .footer-brand .social-row { display:flex; gap:.75rem; margin-top:1.25rem; }
        .footer-brand .social-row a { width:36px; height:36px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1); border-radius:.625rem; display:flex; align-items:center; justify-content:center; color:#94a3b8; font-size:.9rem; text-decoration:none; transition:all .2s; }
        .footer-brand .social-row a:hover { background:#16a34a; border-color:#16a34a; color:white; }
        .footer-col h4 { font-size:.75rem; font-weight:700; color:#e2e8f0; margin-bottom:1.25rem; letter-spacing:.1em; text-transform:uppercase; }
        .footer-col ul { list-style:none; padding:0; margin:0; }
        .footer-col ul li { margin-bottom:.75rem; }
        .footer-col ul li a { color:#64748b; text-decoration:none; font-size:.9375rem; transition:all .2s; }
        .footer-col ul li a:hover { color:#22c55e; padding-left:4px; }
        .footer-bottom { text-align:center; font-size:.875rem; color:#334155; padding-top:1.5rem; }

        @media(max-width:768px){
            .footer-top{grid-template-columns:1fr 1fr}
            .footer-top .footer-brand{grid-column:1/-1}
        }
        @media(max-width:480px){.footer-top{grid-template-columns:1fr}}

        /* Navbar/Mobile Menu Fixes */
        .modern-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .modern-header.scrolled {
            padding: 0.5rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        }
        .mobile-menu {
            position: fixed;
            top: 64px;
            left: 0;
            right: 0;
            background: white;
            padding: 0;
            height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            z-index: 999;
            border-bottom: 1px solid #f1f5f9;
        }
        .mobile-menu.show {
            height: auto;
            opacity: 1;
            padding: 1.5rem;
        }
        .mobile-nav-link {
            padding: 1rem;
            font-size: 1.125rem;
            font-weight: 600;
            color: #475569;
            text-decoration: none;
            border-radius: 0.75rem;
            transition: all 0.2s;
        }
        .mobile-nav-link:hover {
            background: #f8fafc;
            color: #16a34a;
        }
        .mobile-menu-btn span {
            display: block;
            width: 24px;
            height: 2px;
            background: #1e293b;
            margin: 5px 0;
            transition: 0.3s;
        }
        .mobile-menu-btn.active span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
        .mobile-menu-btn.active span:nth-child(2) { opacity: 0; }
        .mobile-menu-btn.active span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
    </style>
    <style>
        /* Ensure nav shows on desktop */
        @media(min-width:1025px){
            .desktop-nav{display:flex!important;align-items:center;}
            .mobile-menu-btn{display:none!important;}
        }
        @media(max-width:1024px){
            .desktop-nav{display:none!important;}
            .mobile-menu-btn{display:flex!important;}
        }
        /* Mobile menu show state */
        .mobile-menu.show{height:auto!important;max-height:calc(100vh - 64px);opacity:1!important;overflow-y:auto;border-bottom:1px solid #e5e7eb;box-shadow:0 10px 40px rgba(0,0,0,.1)}
        .mobile-menu-btn.active span:nth-child(1){transform:translateY(6px) rotate(45deg)}
        .mobile-menu-btn.active span:nth-child(2){opacity:0}
        .mobile-menu-btn.active span:nth-child(3){transform:translateY(-6px) rotate(-45deg)}
        /* Force visible toggle bars + solid header on all viewports */
        .mobile-menu-btn span{display:block!important;transition:all .3s;background-color:#1f2937!important;height:2px!important;width:24px!important;margin:0!important}
        .modern-header{background:rgba(255,255,255,0.97)!important;backdrop-filter:blur(12px)!important}
        /* Solid white mobile menu — no transparency dependency */
        .mobile-menu{background-color:#fff!important}
        .mobile-menu.show{background-color:#fff!important}
    </style>
</head>
<body>

<!-- ═══ NAV ════════════════════════════════════════════════════════════ -->
<header class="modern-header fixed top-0 left-0 right-0 w-full z-[1000] bg-white/95 backdrop-blur-md border-b border-gray-100 transition-all duration-300" id="wnHeader">
    <div class="header-container flex items-center justify-between max-w-[1400px] mx-auto px-4 md:px-8 py-3">
        <a href="../../index.html" class="logo-container flex items-center gap-2.5 no-underline">
            <img src="https://coursecornerkenya.com/assets/images/logo.png" alt="Course Corner Logo" class="h-8 md:h-10 w-auto">
            <div class="logo-text-group flex flex-col justify-center leading-none gap-[2px]">
                <span class="text-[1.15rem] md:text-[1.35rem] font-extrabold text-[#16a34a] tracking-tight leading-none">Course Corner</span>
                <span class="text-[0.55rem] md:text-[0.65rem] font-semibold text-[#0ea5e9] tracking-wide leading-none">Learn Portal</span>
            </div>
        </a>

        <nav class="desktop-nav hidden lg:flex items-center gap-6">
            <a href="../../index.html" class="text-[0.9rem] font-semibold text-gray-600 hover:text-[#16a34a] no-underline transition-colors">Home</a>
            <a href="courses.html" class="text-[0.9rem] font-semibold text-gray-600 hover:text-[#16a34a] no-underline transition-colors">Courses</a>
            <a href="whats-new.html" class="text-[0.9rem] font-semibold text-[#16a34a] no-underline">What's New</a>
            <a href="about.html" class="text-[0.9rem] font-semibold text-gray-600 hover:text-[#16a34a] no-underline transition-colors">About</a>
            <a href="payment.html" class="text-[0.9rem] font-semibold text-gray-600 hover:text-[#16a34a] no-underline transition-colors flex items-center gap-1"><i class="fas fa-credit-card text-xs"></i> Pay</a>
        </nav>

        <!-- Mobile menu btn -->
        <button id="mobileMenuBtn" class="mobile-menu-btn lg:hidden flex flex-col justify-center items-center gap-1.5 w-10 h-10 border-none bg-transparent cursor-pointer" aria-label="Toggle menu">
            <span class="w-6 h-0.5 bg-gray-800 transition-all duration-300"></span>
            <span class="w-6 h-0.5 bg-gray-800 transition-all duration-300"></span>
            <span class="w-6 h-0.5 bg-gray-800 transition-all duration-300"></span>
        </button>
    </div>
    <!-- Mobile menu -->
    <div id="mobileMenu" class="mobile-menu lg:hidden fixed top-[64px] left-0 right-0 h-0 opacity-0 overflow-hidden bg-white/98 backdrop-blur-xl transition-all duration-300 z-[999]">
        <nav class="flex flex-col gap-2 p-6">
            <a href="../../index.html" class="p-4 text-lg font-bold text-gray-800 no-underline rounded-xl hover:bg-gray-50 transition-all" onclick="closeMobileMenu()">Home</a>
            <a href="courses.html" class="p-4 text-lg font-bold text-gray-800 no-underline rounded-xl hover:bg-gray-50 transition-all" onclick="closeMobileMenu()">Courses</a>
            <a href="whats-new.html" class="p-4 text-lg font-bold text-[#16a34a] no-underline rounded-xl bg-green-50 transition-all" onclick="closeMobileMenu()">What's New</a>
            <a href="about.html" class="p-4 text-lg font-bold text-gray-800 no-underline rounded-xl hover:bg-gray-50 transition-all" onclick="closeMobileMenu()">About</a>
            <a href="payment.html" class="p-4 text-lg font-bold text-gray-800 no-underline rounded-xl hover:bg-gray-50 transition-all flex items-center gap-2" onclick="closeMobileMenu()"><i class="fas fa-credit-card text-[#16a34a]"></i> Pay</a>
        </nav>
    </div>
</header>

<!-- ═══ HERO ═══════════════════════════════════════════════════════════ -->
<section class="page-hero">
    <div class="hero-inner">
        <div class="pill"><i class="fas fa-newspaper"></i> Updates &amp; Stories</div>
        <h1 class="hero-title">What's New on<br><span class="g">Course Corner Learn</span></h1>
        <p class="hero-desc">Portal updates, student success stories, and quick tips to help you thrive in the digital world.</p>
    </div>
</section>

<!-- ═══ POSTS ══════════════════════════════════════════════════════════ -->
<main class="posts-section">

    <!-- Check back soon (shown by default, hidden once Firestore posts load) -->
    <div id="emptyState" style="text-align:center;padding:5rem 0 4rem">
        <div style="display:inline-flex;align-items:center;justify-content:center;width:80px;height:80px;background:#f0fdf4;border-radius:50%;margin-bottom:1.5rem">
            <i class="fas fa-bell-slash" style="font-size:2rem;color:#86efac"></i>
        </div>
        <h3 style="font-size:1.25rem;font-weight:700;color:#1f2937;margin-bottom:.5rem">Check Back Soon</h3>
        <p style="color:#6b7280;font-size:.9375rem;max-width:400px;margin:0 auto;line-height:1.65">We're busy putting together great content for you. New posts, portal updates and student spotlights are coming soon.</p>
    </div>

    <!-- Dynamic posts grid (populated from Firestore learnPosts) -->
    <div class="posts-grid" id="postsGrid"></div>

</main>


<footer class="cc-footer">
    <div class="cc-footer-container">
        <div class="cc-footer-grid">
            <div class="cc-footer-brand">
                <div class="flex items-center gap-2 mb-4">
                    <img src="https://coursecornerkenya.com/assets/images/logo.png" class="h-10 w-auto" alt="Course Corner logo" />
                    <div class="flex flex-col leading-none">
                        <span class="text-white font-extrabold text-lg">Course Corner</span>
                        <span class="text-blue-400 font-bold text-[0.6rem] uppercase tracking-wider">Learn Portal</span>
                    </div>
                </div>
                <p>Empowering Kenyan students to gain practical digital skills for the modern economy.</p>
                <div class="cc-social-links flex gap-3 mt-6">
                    <a href="#" class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center text-white hover:bg-[#16a34a] transition-all"><i class="fab fa-whatsapp"></i></a>
                    <a href="#" class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center text-white hover:bg-[#16a34a] transition-all"><i class="fab fa-tiktok"></i></a>
                    <a href="#" class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center text-white hover:bg-[#16a34a] transition-all"><i class="fab fa-twitter"></i></a>
                </div>
            </div>

            <div class="cc-footer-links">
                <h4 class="text-white font-bold uppercase tracking-widest text-xs mb-6">Learn Portal</h4>
                <ul class="space-y-3">
                    <li><a href="../../index.html" class="text-gray-400 hover:text-white transition-all text-sm">Home</a></li>
                    <li><a href="../../index.html#courses" class="text-gray-400 hover:text-white transition-all text-sm">Our Courses</a></li>
                    <li><a href="../../apply.html" class="text-gray-400 hover:text-white transition-all text-sm">Apply Now</a></li>
                    <li><a href="dashboard.html" class="text-gray-400 hover:text-white transition-all text-sm">Student Dashboard</a></li>
                    <li><a href="whats-new.html" class="text-gray-400 hover:text-white transition-all text-sm">What's New</a></li>
                </ul>
            </div>

            <div class="cc-footer-links">
                <h4 class="text-white font-bold uppercase tracking-widest text-xs mb-6">Main Resources</h4>
                <ul class="space-y-3">
                    <li><a href="https://coursecornerkenya.com" onclick="return confirmExternal(event,this)" class="text-gray-400 hover:text-white transition-all text-sm">Main Site</a></li>
                    <li><a href="https://coursecornerkenya.com/pages/calculator.html" onclick="return confirmExternal(event,this)" class="text-gray-400 hover:text-white transition-all text-sm">Cluster Calculator</a></li>
                    <li><a href="https://coursecornerkenya.com/pages/privacy-policy.html" onclick="return confirmExternal(event,this)" class="text-gray-400 hover:text-white transition-all text-sm">Privacy Policy</a></li>
                    <li><a href="https://coursecornerkenya.com/pages/terms-of-service.html" onclick="return confirmExternal(event,this)" class="text-gray-400 hover:text-white transition-all text-sm">Terms of Service</a></li>
                </ul>
            </div>

            <div class="cc-footer-contact">
                <h4 class="text-white font-bold uppercase tracking-widest text-xs mb-6">Contact Support</h4>
                <ul class="space-y-4">
                    <li class="flex items-center gap-3 text-gray-400 text-sm"><i class="fas fa-envelope text-[#16a34a]"></i> info.coursecorner@gmail.com</li>
                    <li class="flex items-center gap-3 text-gray-400 text-sm"><i class="fas fa-phone text-[#16a34a]"></i> 0718 744780</li>
                    <li class="flex items-center gap-3 text-gray-400 text-sm"><i class="fas fa-phone text-[#16a34a]"></i> 0741 739262</li>
                    <li class="flex items-center gap-3 text-gray-400 text-sm"><i class="fas fa-map-marker-alt text-[#16a34a]"></i> Nairobi, Kenya</li>
                </ul>
            </div>
        </div>

        <div class="cc-footer-bottom border-t border-white/5 pt-8 mt-8 text-center">
            <p class="text-gray-500 text-sm">&copy; 2026 Course Corner. All rights reserved. &nbsp;&middot;&nbsp; Empowering Students Through Quality Education</p>
        </div>
    </div>
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
    const app=initializeApp({apiKey:"AIzaSyCt_mM9mwRg0QJpHC4haH7ZsLspVNJI6XM",authDomain:"course-corner.firebaseapp.com",projectId:"course-corner",storageBucket:"course-corner.firebasestorage.app",messagingSenderId:"961706784572",appId:"1:961706784572:web:7aa6c24946570ffda59039"});
    const auth=getAuth(app);
</script>

<script>
    // Scroll header
    window.addEventListener('scroll',()=>document.getElementById('wnHeader').classList.toggle('scrolled',scrollY>10));

    // Mobile menu
    document.addEventListener('DOMContentLoaded', () => {
        const mmBtn = document.getElementById('mobileMenuBtn');
        const mm = document.getElementById('mobileMenu');
        if (mmBtn && mm) {
            mmBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                mm.classList.toggle('show');
                mmBtn.classList.toggle('active');
            });
        }
        document.addEventListener('click', (e) => {
            const mm = document.getElementById('mobileMenu');
            const mmBtn = document.getElementById('mobileMenuBtn');
            if (mm && mm.classList.contains('show') && !mm.contains(e.target) && !mmBtn.contains(e.target)) {
                mm.classList.remove('show');
                mmBtn.classList.remove('active');
            }
        });
    });
    window.closeMobileMenu=()=>{
        const mm = document.getElementById('mobileMenu');
        const mmBtn = document.getElementById('mobileMenuBtn');
        if (mm) mm.classList.remove('show');
        if (mmBtn) mmBtn.classList.remove('active');
    };

    // (Filter tabs removed — posts load directly from Firestore)

    // Load dynamic posts from Firestore (learnPosts collection)
    (async function loadDynamicPosts() {
        try {
            const { getFirestore, collection, query, where, orderBy, getDocs } = await import("https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js");
            const { initializeApp } = await import("https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js");
            const fbApp = initializeApp({
                apiKey:"AIzaSyCt_mM9mwRg0QJpHC4haH7ZsLspVNJI6XM",
                authDomain:"course-corner.firebaseapp.com",
                projectId:"course-corner",
                storageBucket:"course-corner.firebasestorage.app",
                messagingSenderId:"961706784572",
                appId:"1:961706784572:web:7aa6c24946570ffda59039"
            }, 'wn-reader');
            const dbR = getFirestore(fbApp);
            const snap = await getDocs(query(collection(dbR, 'learnPosts'), where('published', '==', true)));
            // Sort client-side — avoids needing a Firestore composite index
            const posts = snap.docs.map(d => ({ id: d.id, ...d.data() }));
            posts.sort((a, b) => {
                const ta = a.createdAt && a.createdAt.toMillis ? a.createdAt.toMillis() : 0;
                const tb = b.createdAt && b.createdAt.toMillis ? b.createdAt.toMillis() : 0;
                return tb - ta;
            });
            // Hide "Check back soon" only when posts exist
            if (posts.length === 0) return;
            const emptyEl = document.getElementById('emptyState');
            if (emptyEl) emptyEl.style.display = 'none';

            const grid = document.getElementById('postsGrid');
            const catStyles = { story:'background:#3b82f6;color:white;', update:'background:#16a34a;color:white;', tip:'background:#8b5cf6;color:white;', news:'background:#f59e0b;color:white;' };
            const catLabels = { story:'Success Story', update:'Platform Update', tip:'Learning Tip', news:'News' };
            const catFilter = { story:'story', update:'news', tip:'tips', news:'news' };

            posts.forEach(p => {
                const ts = p.createdAt && p.createdAt.toDate ? p.createdAt.toDate().toLocaleDateString('en-GB', { month:'short', year:'numeric' }) : '';
                const card = document.createElement('article');
                card.className = 'post-card';
                card.style.cursor = 'pointer';
                card.dataset.cat = catFilter[p.category] || p.category || 'news';
                card.onclick = () => window.location.href = `post.html?id=${p.id}`;
                card.innerHTML = `
                    <div class="post-img">
                        ${p.image ? `<img src="${p.image}" alt="">` : `<div style="width:100%;height:100%;background:linear-gradient(135deg,#e0e7ff,#dbeafe);display:flex;align-items:center;justify-content:center;"><i class="fas fa-newspaper text-4xl text-blue-300"></i></div>`}
                        <div class="overlay"></div>
                        <span class="cat-pill" style="${catStyles[p.category] || 'background:#6b7280;color:white;'}">${catLabels[p.category] || p.category || 'Post'}</span>
                    </div>
                    <div class="post-body">
                        <h3>${p.title || 'Untitled'}</h3>
                        <p>${p.excerpt || ''}</p>
                        <div class="post-meta">
                            <i class="fas fa-calendar-alt text-green-500"></i>
                            <span>${ts}</span>
                            <span class="dot"></span>
                            <span>${p.author || 'Course Corner Team'}</span>
                        </div>
                        <a href="post.html?id=${p.id}" class="read-btn">Read More <i class="fas fa-arrow-right text-xs"></i></a>
                    </div>`;
                grid.appendChild(card);
            });

            // Count banner (optional – posts-header removed, safe to skip)
            const allCards = grid.querySelectorAll('.post-card');
            if (allCards.length > 0) {
                let hdr = document.getElementById('postsCountHdr');
                if (!hdr) {
                    hdr = document.createElement('p');
                    hdr.id = 'postsCountHdr';
                    hdr.style.cssText = 'font-size:.8125rem;color:#9ca3af;text-align:right;margin-bottom:1rem';
                    grid.parentNode.insertBefore(hdr, grid);
                }
                hdr.textContent = `${allCards.length} post${allCards.length !== 1 ? 's' : ''}`;
            }
        } catch (e) { console.error('Dynamic posts load error:', e.message); }
    })();

    // Newsletter
    window.subscribeNL = function() {
        const phone = document.getElementById('nlPhone').value.trim();
        if (!phone) { Swal.fire({icon:'warning',title:'Enter your phone number',confirmButtonColor:'#16a34a'}); return; }
        Swal.fire({icon:'success',title:'Subscribed!',text:`We'll send updates to ${phone} on WhatsApp.`,confirmButtonColor:'#16a34a'});
        const nlPhoneInput = document.getElementById('nlPhone');
        if (nlPhoneInput) nlPhoneInput.value='';
    };

    // External link redirect prompt
    window.confirmExternal = function(e, el) {
        e.preventDefault();
        const url  = el.href;
        const host = new URL(url).hostname.replace('www.','');
        Swal.fire({
            title: 'Leaving Learn Portal',
            html: `You are being redirected to <br><strong>${host}</strong>`,
            icon: 'info',
            showCancelButton: true,
            confirmButtonText: '<i class="fas fa-external-link-alt"></i>&nbsp;Continue',
            cancelButtonText: 'Stay Here',
            confirmButtonColor: '#16a34a',
            cancelButtonColor: '#6b7280',
        }).then(r => { if (r.isConfirmed) window.location.href = url; });
        return false;
    };
</script>
</body>
</html>
