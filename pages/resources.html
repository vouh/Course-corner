<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resources - Course Corner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="../assets/images/1.png">
    <link rel="stylesheet" href="../assets/css/modern-ui.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: var(--cc-font-primary, 'Inter', sans-serif);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            color: #111827;
        }

        /* Resources Layout */
        .resources-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2.25rem 1.25rem 4rem;
        }

        @media (min-width: 1024px) {
            .resources-content {
                padding: 3rem 2rem 4rem;
            }
        }

        .resources-layout {
            display: grid;
            grid-template-columns: minmax(260px, 340px) minmax(0, 1fr);
            gap: 1.25rem;
            align-items: start;
        }

        .resources-layout>div {
            min-width: 0;
        }

        @media (max-width: 980px) {
            .resources-layout {
                grid-template-columns: 1fr;
            }
        }

        .sidebar-card {
            background: #ffffff;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
            border: 1px solid #f3f4f6;
            position: sticky;
            top: 6.75rem;
            max-width: 100%;
        }

        @media (max-width: 980px) {
            .sidebar-card {
                position: static;
                top: auto;
            }
        }

        .sidebar-title {
            font-size: 1rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.5rem;
        }

        .sidebar-section {
            margin-top: 1rem;
        }

        .sidebar-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .resources-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.25rem;
        }

        .resources-title {
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: -0.01em;
            color: #111827;
        }

        .resources-subtitle {
            color: #6b7280;
            font-weight: 500;
            margin-top: 0.25rem;
        }

        /* Search */
        .search-card {
            background: #ffffff;
            border-radius: 1rem;
            padding: 1rem 1.25rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid #f3f4f6;
            margin-bottom: 1.5rem;
        }

        .search-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
        }

        .toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .chip-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
            max-width: 100%;
        }

        .chip {
            border: 1px solid #e5e7eb;
            background: #f9fafb;
            color: #374151;
            font-weight: 500;
            font-size: 0.875rem;
            padding: 0.375rem 0.875rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 0.15s ease, border-color 0.15s ease;
            max-width: 100%;
            white-space: normal;
            text-align: left;
        }

        .chip:hover {
            background: #ecfdf5;
            border-color: #a7f3d0;
            color: #15803d;
        }

        .chip.active {
            background: #dcfce7;
            border-color: #86efac;
            color: #166534;
        }

        .chip.access {
            background: #f3f4f6;
            border-color: #e5e7eb;
            color: #111827;
        }

        .chip.access.active {
            background: #16a34a;
            border-color: transparent;
            color: white;
        }

        .search-input {
            width: 100%;
            border: 1px solid #d1d5db;
            border-radius: 0.625rem;
            padding: 0.75rem 1rem;
            font-weight: 500;
            font-size: 0.9375rem;
            outline: none;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            border-color: #16a34a;
            box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.1);
        }

        .search-hint {
            color: #6b7280;
            font-size: 0.9375rem;
        }

        /* Results */
        .results-card {
            background: white;
            border-radius: 1.25rem;
            padding: 1.25rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e7eb;
        }

        .category-section {
            margin-bottom: 1.75rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            padding-bottom: 0.75rem;
        }

        /* Card Grid (like screenshot) */
        .cards-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin: 1rem 0 0.75rem;
            color: #6b7280;
            font-weight: 500;
            font-size: 0.9375rem;
        }

        .resource-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.25rem;
        }

        @media (max-width: 1280px) {
            .resource-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 980px) {
            .resource-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .resource-grid {
                grid-template-columns: 1fr;
            }
        }

        .resource-card {
            background: #ffffff;
            border: 1px solid #f3f4f6;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
            transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
            display: flex;
            flex-direction: column;
            min-height: 400px;
        }

        .resource-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.08);
            border-color: #d1fae5;
        }

        .card-media {
            position: relative;
            height: 180px;
            background: #f3f4f6;
        }

        .card-media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .rating-badge {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e5e7eb;
            border-radius: 999px;
            padding: 0.25rem 0.55rem;
            font-weight: 600;
            color: #374151;
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            font-size: 0.875rem;
        }

        .rating-badge i {
            color: #f59e0b;
        }

        .card-body {
            padding: 1rem 1.1rem;
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
            flex: 1;
        }

        .category-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            background: #dcfce7;
            color: #166534;
            font-weight: 500;
            border-radius: 999px;
            padding: 0.25rem 0.75rem;
            width: fit-content;
            font-size: 0.8125rem;
        }

        .resource-title {
            font-size: 1.0625rem;
            font-weight: 600;
            color: #111827;
            line-height: 1.4;
        }

        .resource-desc {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
            font-weight: 400;
        }

        .card-meta {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 1rem;
            color: #9ca3af;
            font-size: 0.8125rem;
            font-weight: 400;
            margin-top: auto;
        }

        .meta-left {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
        }

        .meta-right {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
        }

        .card-footer {
            padding: 0.95rem 1.1rem 1.15rem;
            border-top: 1px solid #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .price {
            font-weight: 600;
            color: #dc2626;
            font-size: 1rem;
        }

        .price.free {
            color: #16a34a;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            border-radius: 999px;
            padding: 0.5rem 1.25rem;
            font-weight: 500;
            font-size: 0.875rem;
            border: none;
            background: #111827;
            color: #ffffff;
            text-decoration: none;
            white-space: nowrap;
            min-width: 0;
            transition: background 0.15s ease;
        }

        .btn:hover {
            background: #1f2937;
        }

        .btn.secondary {
            background: #ffffff;
            color: #111827;
            border: 1px solid #d1d5db;
        }

        .btn.secondary:hover {
            background: #f3f4f6;
        }

        .card-actions {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        @media (max-width: 420px) {
            .card-actions {
                width: 100%;
                justify-content: stretch;
            }

            .btn {
                flex: 1 1 140px;
            }
        }
    </style>
</head>

<body class="bg-gray-50">
    <!-- Modern Navigation -->
    <header class="modern-header" id="mainHeader">
        <div class="header-container">
            <a href="../index.html" class="logo">
                <img src="../assets/images/logo.png" alt="Course Corner logo" />
                <span>Course Corner</span>
            </a>

            <nav class="nav-desktop">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="about.html" class="nav-link">About Us</a>
                <a href="calculator.html" class="nav-link">Calculator</a>
                <a href="cluster-points.html" class="nav-link">Cluster Points</a>
                <a href="application-process.html" class="nav-link">Application Guide</a>
                <a href="resources.html" class="nav-link active">Resources</a>
                <a href="guide.html" class="nav-link">Guide</a>
                <a href="contact.html" class="nav-link">Contact</a>
            </nav>

            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <a href="../index.html" class="mobile-nav-link">Home</a>
            <a href="about.html" class="mobile-nav-link">About Us</a>
            <a href="calculator.html" class="mobile-nav-link">Calculator</a>
            <a href="cluster-points.html" class="mobile-nav-link">Cluster Points</a>
            <a href="application-process.html" class="mobile-nav-link">Application Guide</a>
            <a href="resources.html" class="mobile-nav-link active">Resources</a>
            <a href="guide.html" class="mobile-nav-link">Guide</a>
            <a href="contact.html" class="mobile-nav-link">Contact</a>
        </div>
    </header>

    <!-- Main Content -->
    <div class="resources-content" style="padding-top: 7rem;">
        <div class="resources-header">
            <div>
                <div class="resources-title">Resources</div>
                <div class="resources-subtitle">View or download guides and documents (PDF)</div>
            </div>
        </div>

        <div class="resources-layout">
            <aside class="sidebar-card" aria-label="Filters">
                <div class="sidebar-title">Filters</div>

                <div class="sidebar-section">
                    <div class="sidebar-label">Category</div>
                    <div class="chip-row" id="categoryChips" aria-label="Categories"></div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-label">Access</div>
                    <div class="chip-row" aria-label="Access">
                        <button class="chip access active" type="button" data-access="All">All</button>
                        <button class="chip access" type="button" data-access="Free">Free</button>
                        <button class="chip access" type="button" data-access="Paid">Paid</button>
                    </div>
                </div>
            </aside>

            <div>
                <div class="search-card">
                    <div class="search-row">
                        <input id="resourceSearch" class="search-input" type="text"
                            placeholder="Search resources (e.g., KUCCPS, scholarships, application, cluster points…)"
                            autocomplete="off" />
                        <div class="search-hint">Tip: use the filters on the left to narrow down results.</div>
                    </div>
                </div>

                <div class="cards-header">
                    <div id="resultsCount">Showing 0 resources</div>
                </div>

                <div id="resultsRoot"></div>
            </div>
        </div>
    </div>

    <!-- WhatsApp Hub Section -->
    <section class="wa-hub-section">
        <div class="wa-hub-content">
            <h2 class="wa-hub-title">Join Our Academic Community</h2>
            <p class="wa-hub-description">Get instant updates on campus news, application deadlines, and expert career
                guidance directly on your phone.</p>
            <div class="wa-hub-btns">
                <a href="https://chat.whatsapp.com/IiipHgYt5yHL6n126NAKBX" target="_blank" class="btn-wa btn-wa-group">
                    <i class="fab fa-whatsapp"></i>
                    Join WhatsApp Group
                </a>
                <a href="https://whatsapp.com/channel/0029VbBSAavDzgT8eGdkEW0a" target="_blank"
                    class="btn-wa btn-wa-channel">
                    <i class="fas fa-bell"></i>
                    Follow WhatsApp Channel
                </a>
            </div>
        </div>
    </section>

    <!-- Modern Footer -->
    <footer class="modern-footer">
        <div class="footer-container">
            <div class="footer-grid">
                <div class="footer-col">
                    <div class="footer-brand">
                        <img class="footer-logo" src="../assets/images/logo.png" alt="Course Corner logo" />
                        <span>Course Corner</span>
                    </div>
                    <p class="footer-description">
                        Empowering students to make informed decisions about their educational future through
                        personalized course recommendations.
                    </p>
                </div>

                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="calculator.html">Calculator</a></li>
                        <li><a href="cluster-points.html">Cluster Points</a></li>
                        <li><a href="application-process.html">Application Guide</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="resources.html">Resources Library</a></li>
                        <li><a href="guide.html">How to Use</a></li>
                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="terms-of-service.html">Terms of Service</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4>Contact Us</h4>
                    <ul>
                        <li><i class="fas fa-envelope"></i> info@coursecorner.com</li>
                        <li><i class="fas fa-phone"></i> +254 718 744780</li>
                        <li><i class="fas fa-phone"></i> 0741 739162</li>
                    </ul>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-tiktok"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>© Course Corner <span id="currentYear"></span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Set current year
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Mobile menu toggle with state tracking
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        let isMenuOpen = false;

        function openMobileMenu() {
            isMenuOpen = true;
            mobileMenuBtn.classList.add('active');
            mobileMenu.classList.add('active');
        }

        function closeMobileMenu() {
            isMenuOpen = false;
            mobileMenuBtn.classList.remove('active');
            mobileMenu.classList.remove('active');
        }

        function toggleMobileMenu() {
            if (isMenuOpen) closeMobileMenu();
            else openMobileMenu();
        }

        mobileMenuBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleMobileMenu();
        });

        mobileMenu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => closeMobileMenu());
        });

        document.addEventListener('click', (e) => {
            if (isMenuOpen && !mobileMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                closeMobileMenu();
            }
        });

        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024 && isMenuOpen) {
                closeMobileMenu();
            }
        });

        // Header scroll effect
        const header = document.getElementById('mainHeader');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) header.classList.add('scrolled');
            else header.classList.remove('scrolled');
        });

        // ===== Resources Data + Rendering =====
        const resources = [
            {
                category: 'KUCCPS & Placement',
                title: 'KUCCPS Application Checklist',
                description: 'A quick checklist to help you submit your KUCCPS application correctly.',
                fileHref: '../RESOURCES/files/kuccps-checklist.pdf',
                fileType: 'PDF',
                access: 'Free',
                image: '../assets/images/test.png',
                downloadName: 'kuccps-checklist.pdf',
                priceKes: 0,
                rating: 4.9,
                metaLeft: 'PDF',
                metaRight: 'Free'
            },
            {
                category: 'KUCCPS & Placement',
                title: 'Application Timeline Template',
                description: 'A simple timeline template you can reuse to plan your application steps.',
                fileHref: '../RESOURCES/files/application-timeline.pdf',
                fileType: 'PDF',
                access: 'Free',
                image: '../assets/images/test.png',
                downloadName: 'application-timeline.pdf',
                priceKes: 0,
                rating: 4.8,
                metaLeft: 'PDF',
                metaRight: 'Free'
            },
            {
                category: 'Cluster Points & Subjects',
                title: 'Cluster Points Quick Guide',
                description: 'A short guide explaining cluster points and how to use them.',
                fileHref: '../RESOURCES/files/cluster-points-quick-guide.pdf',
                fileType: 'PDF',
                access: 'Free',
                image: '../assets/images/test.png',
                downloadName: 'cluster-points-quick-guide.pdf',
                priceKes: 0,
                rating: 4.9,
                metaLeft: 'PDF',
                metaRight: 'Free'
            },
            {
                category: 'Cluster Points & Subjects',
                title: 'Cluster Guide (Full Pack)',
                description: 'A more detailed pack with extra notes and examples (paid resource).',
                fileHref: '../RESOURCES/files/cluster-guide-full-pack.pdf',
                fileType: 'PDF',
                access: 'Paid',
                image: '../assets/images/test.png',
                priceKes: 250,
                rating: 4.7,
                metaLeft: 'PDF',
                metaRight: 'Paid'
            },
            {
                category: 'Applications & Admissions',
                title: 'Scholarship Checklist',
                description: 'Common documents and steps to prepare before applying for scholarships.',
                fileHref: '../RESOURCES/files/scholarship-checklist.pdf',
                fileType: 'PDF',
                access: 'Free',
                image: '../assets/images/test.png',
                downloadName: 'scholarship-checklist.pdf',
                priceKes: 0,
                rating: 4.8,
                metaLeft: 'PDF',
                metaRight: 'Free'
            },
            {
                category: 'Scholarships & Funding',
                title: 'Career Planning Mini-Workbook',
                description: 'A simple workbook to help you shortlist careers and next steps (paid resource).',
                fileHref: '../RESOURCES/files/career-planning-workbook.pdf',
                fileType: 'PDF',
                access: 'Paid',
                image: '../assets/images/test.png',
                priceKes: 300,
                rating: 4.6,
                metaLeft: 'PDF',
                metaRight: 'Paid'
            },
            {
                category: 'Career Planning',
                title: 'Career Planning Mini-Workbook (Free Sample)',
                description: 'A free sample workbook to help you start planning your career.',
                fileHref: '../RESOURCES/files/career-planning-workbook-sample.pdf',
                fileType: 'PDF',
                access: 'Free',
                image: '../assets/images/test.png',
                downloadName: 'career-planning-workbook-sample.pdf',
                priceKes: 0,
                rating: 4.8,
                metaLeft: 'PDF',
                metaRight: 'Free'
            },
            {
                category: 'Guides',
                title: 'How to Use Course Corner',
                description: 'Step-by-step guide on how to use the calculator, cluster guide, and resources.',
                fileHref: '../RESOURCES/files/how-to-use-course-corner.pdf',
                fileType: 'PDF',
                access: 'Free',
                image: '../assets/images/test.png',
                downloadName: 'how-to-use-course-corner.pdf',
                priceKes: 0,
                rating: 4.7,
                metaLeft: 'PDF',
                metaRight: 'Free'
            }
        ];

        const state = {
            activeCategory: 'All',
            query: '',
            access: 'All'
        };

        const categoryChipsEl = document.getElementById('categoryChips');
        const resultsRootEl = document.getElementById('resultsRoot');
        const searchEl = document.getElementById('resourceSearch');
        const resultsCountEl = document.getElementById('resultsCount');

        function normalize(text) {
            return (text || '').toString().toLowerCase().trim();
        }

        function getCategories() {
            const set = new Set(resources.map(r => r.category));
            return ['All', ...Array.from(set).sort((a, b) => a.localeCompare(b))];
        }

        function filterResources() {
            const q = normalize(state.query);
            return resources.filter(r => {
                const matchesQuery = !q || normalize(r.title).includes(q) || normalize(r.description).includes(q) || normalize(r.category).includes(q);
                const matchesCategory = state.activeCategory === 'All' || r.category === state.activeCategory;
                const matchesAccess = state.access === 'All' || r.access === state.access;
                return matchesQuery && matchesCategory && matchesAccess;
            });
        }

        function renderCategoryChips() {
            const categories = getCategories();
            categoryChipsEl.innerHTML = '';

            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'chip' + (state.activeCategory === cat ? ' active' : '');
                btn.textContent = cat;
                btn.addEventListener('click', () => {
                    state.activeCategory = cat;
                    render();
                });
                categoryChipsEl.appendChild(btn);
            });
        }

        function renderResults() {
            const filtered = filterResources();

            if (resultsCountEl) {
                resultsCountEl.textContent = `Showing ${filtered.length} resources`;
            }

            if (filtered.length === 0) {
                resultsRootEl.innerHTML = `
                    <div class="empty-state">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">No results</div>
                        <div>Try a different search, or choose <strong>All</strong> categories.</div>
                    </div>
                `;
                return;
            }

            const cards = filtered.map(r => {
                const imageSrc = r.image || '../assets/images/1.png';
                const viewHref = r.fileHref || '#';
                const isFree = r.access !== 'Paid';
                const downloadAttr = isFree ? ` download="${(r.downloadName || '').replace(/\"/g, '')}"` : '';
                const priceText = (r.priceKes || 0) > 0 ? `KES ${Number(r.priceKes).toLocaleString()}` : 'Free';
                const priceClass = (r.priceKes || 0) > 0 ? '' : 'free';
                const rating = typeof r.rating === 'number' ? r.rating.toFixed(1) : '4.8';
                const metaLeft = r.metaLeft || (r.fileType || 'PDF');
                const metaRight = r.metaRight || (r.access || 'Free');

                // Build detail page URL with query params
                const detailParams = new URLSearchParams({
                    title: r.title || '',
                    category: r.category || '',
                    description: r.description || '',
                    image: r.image || '',
                    rating: rating,
                    fileType: r.fileType || 'PDF',
                    access: r.access || 'Free',
                    priceKes: r.priceKes || 0,
                    fileHref: r.fileHref || '',
                    downloadName: r.downloadName || ''
                });
                const detailHref = `resource-detail.html?${detailParams.toString()}`;

                const actionHtml = isFree
                    ? `
                        <div class="card-actions">
                            <a class="btn secondary" href="${detailHref}">View</a>
                            <a class="btn" href="${viewHref}"${downloadAttr}>Download</a>
                        </div>
                    `
                    : `
                        <div class="card-actions">
                            <a class="btn secondary" href="${detailHref}">View</a>
                            <a class="btn" href="contact.html">Get Access</a>
                        </div>
                    `;

                return `
                    <article class="resource-card">
                        <div class="card-media">
                            <img src="${imageSrc}" alt="${(r.title || 'Resource').replace(/\"/g, '')}" loading="lazy" onerror="this.src='../assets/images/1.png'" />
                            <div class="rating-badge"><i class="fas fa-star"></i> ${rating}</div>
                        </div>
                        <div class="card-body">
                            <div class="category-pill">${r.category || 'Resource'}</div>
                            <div class="resource-title">${r.title || 'Resource'}</div>
                            <div class="resource-desc">${r.description || ''}</div>
                            <div class="card-meta">
                                <div class="meta-left"><i class="fas fa-file-pdf"></i> ${metaLeft}</div>
                                <div class="meta-right"><i class="fas fa-user"></i> ${metaRight}</div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="price ${priceClass}">${priceText}</div>
                            ${actionHtml}
                        </div>
                    </article>
                `;
            }).join('');

            resultsRootEl.innerHTML = `<div class="resource-grid">${cards}</div>`;
        }

        function render() {
            renderCategoryChips();
            renderResults();
        }

        searchEl.addEventListener('input', (e) => {
            state.query = e.target.value || '';
            // If the active category is now empty under this query, fall back to All
            const matches = resources.filter(r => {
                const q = normalize(state.query);
                const matchesQuery = !q || normalize(r.title).includes(q) || normalize(r.description).includes(q) || normalize(r.category).includes(q);
                const matchesCategory = state.activeCategory === 'All' || r.category === state.activeCategory;
                const matchesAccess = state.access === 'All' || r.access === state.access;
                return matchesQuery && matchesCategory && matchesAccess;
            });
            if (matches.length === 0 && state.activeCategory !== 'All') {
                state.activeCategory = 'All';
            }
            render();
        });

        // Access filter chips
        document.querySelectorAll('.chip.access').forEach(btn => {
            btn.addEventListener('click', () => {
                const next = btn.getAttribute('data-access') || 'All';
                state.access = next;
                document.querySelectorAll('.chip.access').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                render();
            });
        });

        render();
    </script>

    <!-- Floating Referral Bubble -->
    <a href="../index.html#referral-program" class="referral-bubble">
        <i class="fas fa-gift"></i>
        <span>Earn 10%</span>
    </a>
    <!-- WhatsApp Floating CTAs -->
    <div class="wa-floating-container">
        <a href="https://chat.whatsapp.com/IiipHgYt5yHL6n126NAKBX" target="_blank" class="wa-fab wa-fab-group"
            title="Join WhatsApp Group">
            <i class="fab fa-whatsapp"></i>
            <span>WhatsApp Group</span>
        </a>
        <a href="https://whatsapp.com/channel/0029VbBSAavDzgT8eGdkEW0a" target="_blank" class="wa-fab wa-fab-channel"
            title="Follow WhatsApp Channel">
            <i class="fas fa-bell"></i>
            <span>WhatsApp Channel</span>
        </a>
    </div>
</body>

</html>